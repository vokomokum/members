<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal">
    <div metal:use-macro="view.layout.macros['master']">
        <div metal:fill-slot="content">


<!-- show toggle active state confirmation -->
<form tal:condition="python: hasattr(view, 'confirm_toggle_active') and m.mem_id"
      action="${portal_url}/member/${m.mem_id}/edit" method="post">
    <div class="warn" tal:condition="m.mem_active">
        Really set member ${m.fullname} to inactive?
    </div>
    <div class="warn" tal:condition="not:m.mem_active">
        Really set member ${m.fullname} to active?
    </div>
    <button type="submit" value="toggle-active-confirmed" name="action">Yes</button>
    <button type="submit" value="donothing" name="action">No</button>
</form>


<!-- show member form -->
<form tal:condition="python: m and not hasattr(view, 'confirm_deletion')"
      tal:attributes="action python: '%s/member/%s/edit' % (portal_url, str(m.mem_id) if m.mem_id else 'new')"
      method="post">
    
    <h1>Editing Member Details</h1>

    <div id="action-box">
        <a class="view-link" href="${portal_url}/member/${m.mem_id}">view this member</a>
    </div>

    <button tal:condition="m.exists and view.user_may_edit_admin_settings"
            name="action" type="submit" value="toggle-active"
            class="action-button action-button-red">
        <span tal:condition="m.mem_active">Make inactive</span>
        <span tal:condition="not:m.mem_active">Make active</span>
    </button>

    <span class="warn">(fields with * are required)</span>

    <input tal:condition="m.exists"
           type="hidden" name="id" value="${m.mem_id}">
    </input>

    <!-- Name & email -->
    <span class="bold">
    <table class="list" width="100%">
      <tr class="list-content">
        <td align="center" colspan="4">Name and Email</td>
      </tr>
      <tr class="list-content">
        <td align="left" width="25%"> <span class="warn">*</span> Forename:</td> 
        <td align="left" width="10%">Prefix:</td>
        <td align="left" width="25%"> <span class="warn">*</span> Last Name:</td>
        <td align="left" width="40%"> <span class="warn">*</span> Email:</td>
      </tr>
      <tr class="list-content">
        <td><input type="text" align="left" size="15" name="mem_fname"
                   value="${m.mem_fname}" maxlength="20"></input></td> 
        <td><input type="text" align="left" size="5" name="mem_prefix"
                   value="${m.mem_prefix}" maxlength="10"></input></td>
        <td><input type="text" align="left" size="18" name="mem_lname"
                   value="${m.mem_lname}" maxlength="20"></input></td>
        <td><input type="text" align="left" size="35" name="mem_email"
                   value="${m.mem_email}" maxlength="50"></input></td>
      </tr>
    </table>
    </span>

    <!-- Address -->
    <table class="list" width="100%"> 
      <tr class="list-content">
        <td align="center" colspan="5">Address</td>
      </tr>
      <tr class="list-content">
        <td align="left" width="50%">Street:</td>
        <td align="left" width="10%">House No.:</td>
        <td align="left" width="10%">Hs./Apt. No:</td>
        <td align="left" width="10%">Postcode:</td>
        <td align="left" width="25%">City:</td>
      </tr>
      <tr class="list-content">
        <td><input type="text" align="left" size="40" name="mem_street"
                 Value="${m.mem_street}" maxlength="30"></input></td>
        <td><input type="text" align="left" size="7" name="mem_house"
                 Value="${m.mem_house}" maxlength="7"></input></td>
        <td><input type="text" align="left" size="7" name="mem_flatno"
                 Value="${m.mem_flatno}" maxlength="7"></input></td>
        <td><input type="text" align="left" size="7" name="mem_postcode"
                 Value="${m.mem_postcode}" maxlength="7"></input></td>
        <td><input type="text" align="left" size="15" name="mem_city"
                Value="${m.mem_city}" maxlength="60"></input></td>
      </tr>
    </table>


    <!-- Phone -->

    <table class="list" width="100%"> 
      <tr class="list-content">
        <td align="center" colspan="3">Telephone <span class="warn">(At least one is required)</span></td>
      </tr>
      <tr class="list-content">
        <td align="left" width="33%">Home:</td> 
        <td align="left" width="33%">Work:</td>
        <td align="left" width="33%">Mobile:</td> 
      </tr>
      <tr class="list-content">
        <td><input type="text" align="left" size="20" name="mem_home_tel"
                 Value="${m.mem_home_tel}" maxlength="20"></input></td>
        <td><input type="text" align="left" size="20" name="mem_work_tel"
                 Value="${m.mem_work_tel}" maxlength="20"></input></td>
        <td><input type="text" align="left" size="20" name="mem_mobile"
                 Value="${m.mem_mobile}" maxlength="20"></input></td>
      </tr>
    </table>


    <!-- Bank details: We actually do not need nor want this anymore -->

    <!--table class="main" width="100%">
       <tr class="list-content" align="center">
         <td colspan="2">Bank Account</td>
       </tr>
       <tr class="list-content" align="center">
         <td><input type="text" align="left" size="12" name="mem_bank_no"
                 Value="${m.mem_bank_no}" maxlength="12"></input></td>
      </tr>
    </table-->


    <table width="100%" class="main" id="admin-settings" tal:condition="view.user_may_edit_admin_settings">
        <!-- Admin Settings TODO: add admin comment box -->
           <tr class="list-content">
             <td align="center" colspan="2">Account Settings</td>
           </tr>
           <tr class="list-content">
             <td align="right">
                <input type="checkbox" name="mem_membership_paid" checked="${m.mem_membership_paid}" /></td>
             <td align="left"><label for="mem_membership_paid">Membership fee is paid</label></td>
           </tr>
           <tr class="list-content">
             <td align="right"> 
                <input type="checkbox" name="mem_admin" checked="${m.mem_admin}" /></td>
             <td align="left"><label for="mem_admin">Member has general administrator privileges</label></td>
           </tr>
           <tr class="list-content">
             <td align="right"> 
                <input type="checkbox" name="mem_adm_adj" checked="${m.mem_adm_adj}" /></td>
             <td align="left"><label for="mem_adm_adj">Order admin account - can order goods after commits are closed</label></td>
           </tr>
           <tr class="list-content">
             <td colspan="2" align="center">Admin Comments for this member:</td>
           </tr>
           <tr class="list-content">
             <td colspan="2" align="center"> 
                <textarea name="mem_adm_comment"
                       tal:content="m.mem_adm_comment" rows="7" cols="60">
                </textarea>
             </td>
           </tr>
    </table>

    <!-- Submit -->
    <table width="100%">
        <tr align="center">
            <td width="80%"></td>
            <td width="20%" align="center">
                <button name="action" type="submit" value="save">
                    <img src="${portal_url}/static/img/icons/save.png"/>
                </button>
            </td>
        </tr>
    </table>

</form>


        </div>
    </div>
</html>
