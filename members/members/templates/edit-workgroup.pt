<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal">
    <div metal:use-macro="view.layout.macros['master']">
        <div metal:fill-slot="content">

<!-- show deletion confirmation -->
<form tal:condition="python: hasattr(view, 'confirm_deletion') and wg.id"
      action="${portal_url}/workgroup/${wg.id}/edit" method="post">
    <div class="warn">Really delete workgroup ${wg.name}?</div>
    <button type="submit" value="delete-confirmed" name="action" class="btn btn-default">Yes</button>
    <button type="submit" value="donothing" name="action" class="btn btn-default">No</button>
</form>

<!-- show wg form and tasks -->
<div tal:condition="not: python: hasattr(view, 'confirm_deletion')">
<form tal:attributes="action python: '%s/workgroup/%s/edit' % (portal_url, str(wg.id) if wg.id else 'new')"
      method="post" tal:condition="wg" role="form" class="form-horizontal">

    <h1>Editing Workgroup ${wg.name}</h1>
    
    <div id="action-box" tal:condition="wg.exists">
        <a class="btn btn-link" href="${portal_url}/workgroup/${wg.id}"><span class="glyphicon glyphicon-eye-open"></span> view this group</a>
        <button tal:condition="wg.exists" type="image" title="delete" value="delete" name="action" class="btn btn-link"><span class="glyphicon glyphicon-remove"></span> delete</button>
        <input type="hidden" name="id" value="${wg.id}"></input>
    </div> 

    <!-- Data -->
    <div class="form-group">
      <label class="col-sm-2" for="name">Name:</label>
      <div class="col-sm-6">
        <input type="text" class="form-control" action="name" value="${wg.name}"/>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2" for="wg_leaders">Coordinators:</label>
      <div class="col-sm-6">
        <select name="wg_leaders" id="wg_leaders" multiple="multiple"
                  data-placeholder="Start typing or click to select members"
                  class="chzn-select">
          <tal:block tal:repeat="pm view.possible_members">
              <option tal:condition="python: pm in wg.active_leaders"
                      tal:content="pm.fullname" selected="selected"
                      value="${pm.mem_id}">
              </option>
              <option tal:condition="python: not pm in wg.active_leaders"
                      tal:content="pm.fullname" value="${pm.mem_id}">
              </option>
          </tal:block>
        </select>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2" for="wg_members">Members:</label>
      <div class="col-sm-6">
        <span class="help-block">
          To add members, click in the boxes and then start typing names or select from the list.
        </span>
          <select name="wg_members" id="wg_members" multiple="multiple"
                  data-placeholder="Start typing or click to select members"
                  class="chzn-select">
              <tal:block tal:repeat="pm view.possible_members">
                  <option tal:condition="python:pm in wg.active_members"
                          tal:content="pm.fullname"
                          value="${pm.mem_id}" selected="selected">
                  </option>
                  <option tal:condition="python:pm not in wg.active_members"
                          tal:content="pm.fullname" value="${pm.mem_id}">
                  </option>
              </tal:block>
          </select>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2" for="description">Description:</label>
      <div class="col-sm-6">
        <textarea tal:content="wg.desc" rows="6" class="form-control"></textarea>
      </div>
    </div>
    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-10">
        <button type="submit" title="Save" name="action" value="save" class="btn btn-primary">Save</button>
      </div>
    </div>


</form>

</div>



        </div>
    </div>
</html>
