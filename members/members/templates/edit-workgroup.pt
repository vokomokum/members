<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal">
    <div metal:use-macro="view.layout.macros['master']">
        <div metal:fill-slot="content">

<!-- show deletion confirmation -->
<form tal:condition="python: hasattr(view, 'confirm_deletion') and wg.id"
      action="${portal_url}/workgroup/${wg.id}/edit" method="post">
    <div class="warn">Really delete workgroup ${wg.name}?</div>
    <button type="submit" value="delete-confirmed" name="action">Yes</button>
    <button type="submit" value="donothing" name="action">No</button>
</form>

<!-- show wg form and tasks -->
<div tal:condition="not: python: hasattr(view, 'confirm_deletion')">
<form tal:attributes="action python: '%s/workgroup/%s/edit' % (portal_url, str(wg.id) if wg.id else 'new')"
      method="post" tal:condition="wg">

    <h1>Editing Workgroup ${wg.name}</h1>
    
    <div id="action-box" tal:condition="wg.exists">
        <a class="view-link" href="${portal_url}/workgroup/${wg.id}">view this group</a>
        <input type="hidden" name="id" value="${wg.id}"></input>
    </div>    

    <!-- Data -->
    <table class="list" width="100%" id="wg_table">
      <tr>
        <th align="center">Name:</th>
        <td align="center">
            <input type="text" align="left" size="40" name="name"
                   value="${wg.name}" maxlength="255">
            </input>
        </td>
        <td colspan="2"></td> 
      </tr>
      <tr>
        <th align="center" width="50%" colspan="2">Admins:</th>
        <th align="center" width="50%" colspan="2">Members:</th>
      </tr>
      <tr class="list-content">
        <td colspan="4" align="center">
            <small>Hold Ctrl (Mac:Cmd) while (de)selecting members.</small>
        </td>
      </tr>
      <tr class="list-content">
        <td colspan="2" align="center">
          <select name="wg_leaders" id="wg_leaders"
                    size="${python:len(view.possible_members)}"
                    multiple="multiple">
            <tal:block tal:repeat="pm view.possible_members">
                <option tal:condition="python: pm in wg.leaders"
                        tal:content="pm.fullname" selected="selected"
                        value="${pm.mem_id}">
                </option>
                <option tal:condition="python: not pm in wg.leaders"
                        tal:content="pm.fullname" value="${pm.mem_id}">
                </option>
            </tal:block>
          </select>
        </td>
        <td colspan="2" align="center">
            <select name="wg_members" id="wg_members"
                    size="${python:len(view.possible_members)}"
                    multiple="multiple">
                <tal:block tal:repeat="pm view.possible_members">
                    <option tal:condition="python:pm in wg.members"
                            tal:content="pm.fullname" 
                            value="${pm.mem_id}" selected="selected">
                    </option>
                    <option tal:condition="python:pm not in wg.members"
                            tal:content="pm.fullname" value="${pm.mem_id}">
                    </option>
                </tal:block>
            </select>
        </td>
      </tr>
      <tr>
        <th align="center" colspan="4">Description:</th>
      </tr>
      <tr>
        <td colspan="4" align="center">
            <textarea tal:content="wg.desc" rows="8" cols="80" name="desc"></textarea>
        </td>
      </tr>
    </table>

    <!-- Submit -->
    <table width="80%">
        <tr align="center">
            <td width="80%"></td>
            <td width="20%" align="center">
                <button type="submit" title="save" value="save" name="action">
                    <img src="${portal_url}/static/img/icons/save.png"/>
                </button>
                <button tal:condition="wg.exists" type="image" title="delete" value="delete" name="action">
                    <img src="${portal_url}/static/img/icons/delete.gif"/>
                </button>
            </td>
        </tr>
    </table>

</form>

</div>



        </div>
    </div>
</html>
