<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:define-macro="master"
      tal:define="portal_url request.application_url">

    <head profile="http://www.w3.org/2005/10/profile">

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="shortcut icon" href="${portal_url}/static/img/favicon.ico" type="image/x-icon" />
        <link rel="stylesheet" type="text/css" href="${portal_url}/static/members.css" />
        <script type="text/javascript" src="${portal_url}/static/jquery.js"></script>
        <!-- Internet Explorer Fixes -->
        <tal:iefixstart replace="structure string:&lt;!--[if IE]&gt;" />
        <link rel="stylesheet" type="text/css" href="${portal_url}/ie.css" />
        <tal:iefixend replace="structure string:&lt;![endif]--&gt;" />
        <title tal:content="view.title | title | 'Vokomokum Members'">Vokomokum Members</title>
        <link rel="shortcut icon" type="image/x-icon" href="${portal_url}/static/img/favicon.ico" />
 
    </head>

    <body>

        <div id="container">

            <div id="header">
                <div id="title"><a href="${portal_url}">Members</a></div>

                <ul id="menu-actions">
                    <tal:block tal:condition="view.logged_in">
                    <li>
                        <a id="logout-link" href="${portal_url}/logout" title="Log out">Log Out</a>
                    </li>
                    <li>
                        <a id="profile-link" href="${portal_url}/member/${view.user.mem_id}" title="My Account" tal:content="view.user.fullname">Account</a>
                    </li>
                    </tal:block>
                    
                    <tal:block tal:condition="not view.logged_in and not view.login_necessary">
                    <!-- Only used seldom, bcs if login is necessary, we show login form automatically anyway -->
                    <li>
                        <a href="/login">Log In</a>
                    </li>
                    </tal:block>
                </ul>

                <ul id="menu-items">
                    <tal:block tal:condition="tab and view.logged_in" tal:define="tab view.tab | None">
                        <li tal:attributes="class python: tab == 'home' and 'current' or ''">
                            <a tal:attributes="href string:${portal_url}">Home</a>
                        </li>
                        <li tal:attributes="class python: tab == 'members' and 'current' or ''">
                            <a tal:attributes="href string:${portal_url}/members">Members</a>
                        </li>
                        <li tal:attributes="class python: tab == 'workgroups' and 'current' or ''">
                            <a tal:attributes="href string:${portal_url}/workgroups">Workgroups</a>
                        </li>
                        <li tal:attributes="class python: tab == 'applicants' and 'current' or ''"
                            tal:condition="python: 'Membership' in [wg.name for wg in view.user.led_workgroups]">
                            <a tal:attributes="href string:${portal_url}/applicants">Applicants</a>
                        </li>
                    </tal:block>
                </ul>

            </div>

            <div id="content">
                
                <h4 tal:condition="msg | False">${msg}</h4>

                <h5 class="warn" tal:condition="info | False">${info}</h5>
                
                <tal:block tal:condition="not view.logged_in and view.login_necessary">
                    <form action="${portal_url}/login" method="post">
                        <table class="main" align="center">
                            <tr>
                                <td>Id or email-address:</td>
                                <td>
                                    <input tal:define="origin came_from | '/'" type="hidden" name="came_from" length="30" value="${origin}"/>
                                    <input type="text" name="login" length="30"/>
                                </td>
                            </tr>
                            <tr>
                                <td>Password:</td>
                                <td>
                                    <input type="password" name="passwd" length="30"/>
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <input type="submit" name="form.submitted" value="Login"/>
                                </td>
                            </tr>
                        </table>
                        <a href="reset-pwd">
                            Forgot Password?
                        </a>
                    </form>
                </tal:block>

                <tal:block tal:condition="view.logged_in or not view.login_necessary">
                    <metal:block define-slot="content">
                        <div metal:define-macro="content" />
                    </metal:block>
                </tal:block>
            </div>

            <div id="footer">
                >>>
                <a href="mailto:info@vokomokum.nl">
                    info@vokomokum.nl
                </a>
                :::
                <a href="http://vokomokum.nl"
                    alt="Vokomokum Food Cooperative"
                    title="Go to Vokomokum Food Cooperative">
                    www.vokomokum.nl
                </a>
            </div>

        </div>

        <script type="text/javascript">
            // shed outer layout when this is embedded (e.g. in an iframe)
            if (top != self) {
                var head = document.getElementsByTagName("head")[0];
                var css = document.createElement('link');
                css.type = 'text/css';
                css.rel = 'stylesheet';
                css.href = '${portal_url}' + "/static/embed.css";
                css.media = 'screen';
                head.appendChild(css);
            }
        </script>
    </body>

</html>
